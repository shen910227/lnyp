var orderCenter={};orderCenter.addEvt=function(){var a=document.getElementsByTagName("aside");for(var b=0;b<a.length;b++){a[b].addEventListener("click",function(c){c.currentTarget.className="hide"});a[b].firstElementChild.addEventListener("click",function(c){c.stopPropagation()})}document.getElementById("show-login").addEventListener("click",function(){document.getElementById("login").className="show"});document.getElementById("show-rig").addEventListener("click",function(){document.getElementById("reg").className="show"});document.querySelector("#userdata .user").addEventListener("click",function(){var c=document.getElementById("login");c.className="show"})};orderCenter.addGetVeriyCode=function(){document.getElementById("get-ver").addEventListener("click",function(c){var d=document.getElementById("reg").querySelector(".phonenumber").value;if(!/\D/.test(d)&&/^\d{11}$/.test(d)){if(c.currentTarget.dataset.lock=="off"){return false}var e=60;var b=setInterval(function(){c.target.innerText="获取中("+e+")";if(--e==0){a()}},1000);c.currentTarget.dataset.lock="off";function a(){clearInterval(b);c.target.dataset.lock="on";c.target.innerText="获取验证码"}ai.post("SmsServer/SMS/SendSmsCode",{smstype:1,phonenumber:d},false).load(function(f){if(f.ResultCode!=1000){ai.alert(f.Message)}a()},false)}else{ai.alert("电话号码格式不对")}})};orderCenter.addNext=function(){document.getElementById("next").addEventListener("click",function(a){var b=document.getElementById("reg").querySelector(".phonenumber").value;var c=document.getElementById("veriycode").value;if(/\D/.test(b)&&!/^\d{11}$/.test(b)){ai.alert("电话号码格式不对")}else{if(!c.length>0){ai.alert("验证码不能为空")}else{orderCenter.next(c,b)}}})};orderCenter.next=function(b,a){ai.post("SmsServer/SMS/VerifySignCode",{signcode:b,phonenumber:a},false).load(function(c){if(c.ResultCode==1000){document.getElementById("reg").className="hide";document.getElementById("nex").className="show"}},false)};orderCenter.addReg=function(){document.getElementById("conf").addEventListener("click",function(){var b=document.getElementById("reg").querySelector(".phonenumber").value;var d=document.getElementById("veriycode").value;var a=document.getElementById("nex").querySelector(".newphonenumber").value;var c=document.getElementById("nex").querySelector(".repeatnewphonenumber").value;if(a.length==0){ai.alert("密码设置不能为空")}else{if(c.length==0){ai.alert("再次密码填写不能为空")}else{if(a!=c){ai.alert("两次输入的密码不正确")}else{orderCenter.reg(d,b,a,c)}}}})};orderCenter.reg=function(d,b,a,c){ai.post("StoreServer/Store/RegisterStore",{smscode:d,phonenumber:b,newPassword:a,repeatNewPassword:c,},false).load(function(e){if(e.ResultCode==1000){document.getElementById("nex").className="hide";ai.alert(e.Message);orderCenter.login(b,a)}else{ai.alert(e.Message)}},false)};orderCenter.addLogin=function(){document.getElementById("login-but").addEventListener("click",function(){var b=document.getElementById("login").querySelector(".phonenumber").value;var a=document.getElementById("login").querySelector(".password").value;if(b.length==0){ai.alert("账号不能为空")}else{if(a.length==0){ai.alert("密码不能为空")}else{orderCenter.login(b,a)}}})};orderCenter.login=function(b,a){ai.post("StoreServer/Store/VerifyAccount",{username:b,password:a,},false).load(function(f){if(f.ResultCode==1000){var c=document.querySelector("#userdata .user");var e=document.querySelector("#userdata .buts");var d=document.getElementById("login");localStorage.loginjson=JSON.stringify({storeLogo:f.Data.storeLogo,storeName:f.Data.storeName,});localStorage.lnyptoken=f.Data.token;ai.vm(c,f.Data);d.className="hide";c.classList.add("show");e.classList.remove("show")}else{ai.alert(f.Message)}},false)};orderCenter.autologin=function(){if(localStorage.loginjson&&localStorage.loginjson!="null"){var c=JSON.parse(localStorage.loginjson);var a=document.querySelector("#userdata .user");var b=document.querySelector("#userdata .buts");ai.vm(a,c);document.querySelector("#userdata .user").classList.add("show");b.classList.remove("show")}};orderCenter.exe=function(){orderCenter.autologin();orderCenter.addEvt();orderCenter.addGetVeriyCode();orderCenter.addNext();orderCenter.addReg();orderCenter.addLogin()};typeof(window.ai)==="undefined"?document.addEventListener("aideload",function(){ai.ready(orderCenter.exe)}):ai.ready(orderCenter.exe);